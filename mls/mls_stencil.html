<!DOCTYPE html>
<html>
<head>
	<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
	<meta content="utf-8" http-equiv="encoding">
	<title> Moving least squares -Demo </title>
</head>
<body>
	<heading><b>Moving Least Squares - Stencil</b></heading>
	<br>
	<canvas id="canvasInAPerfectWorld" width="1" height="1"></canvas>
	<div id="canvasDiv"></div>
	<textarea id="textarea" rows="10" cols="55" placeholder="No points yet"></textarea>
	<br>
	<button type="button" id="b4" onclick="read_plist_into_ui()" style="width:100px;height:100px;font-size:30" >Get p</button>
	<button type="button" id="b1" onclick="get_rlist()" style="width:100px;height:100px;font-size:30" >r lists</button>
	<button type="button" id="b2" onclick="get_qHlist()" style="width:100px;height:100px;font-size:30" >qH lists</button>
	<button type="button" id="b3" onclick="get_q_list()" style="width:100px;height:100px;font-size:30" >q' lists</button>	
	<br><br>
	<div id="debug">
		Debugging area
	</div>

	<script>

		//############################### GIVEN CODE - YOU DON'T HAVE TO CODE HERE ######################//

		//Canvas initializations
		context = document.getElementById('canvasInAPerfectWorld').getContext("2d");
		button = document.getElementById('button')
		canvasWidth = 400;
		canvasHeight = 400;
		var canvasDiv = document.getElementById('canvasDiv');
		canvas = document.createElement('canvas');
		canvas.setAttribute('width', canvasWidth);
		canvas.setAttribute('height', canvasHeight);
		canvas.setAttribute('id', 'canvas');
		canvasDiv.appendChild(canvas);

		context = canvas.getContext("2d");
		
		//Canvas color and size 
		context.fillStyle = "#663300";
		context.fillRect(0,0,canvasWidth, canvasHeight);

		//Global variables
		var storepts_x = new Array();
		var storepts_y = new Array();
		var paint;
		
		//Function that plots the points
		function initdraw(){
		  context.clearRect(0, 0, context.canvas.width, context.canvas.height); // Clears the canvas
		  context.fillStyle = "#663300";
		  context.fillRect(0,0,canvasWidth, canvasHeight);
		  context.strokeStyle = "#df4b26";
		  context.lineJoin = "round";
		  context.lineWidth = 5;
		}

		function draw_points(){
			//context.strokeStyle = "#FFFFFF";
			for (var i=0; i< storepts_x.length; i++){
				console.log(storepts_x[i]+" "+storepts_y[i]);
				context.beginPath();
				context.moveTo(storepts_x[i]-1, 10*Math.ceil(storepts_y[i]/10));
				context.lineTo(storepts_x[i], 10*Math.ceil(storepts_y[i]/10));
				context.closePath();
			    context.stroke();
			}
		}	

		function read_plist_into_ui(){			
			initdraw();
			var text = document.getElementById("textarea").value;
			storepts_x.length = 0;
			storepts_y.length = 0;
			var sp_lines = text.split('\n');
			console.log("size of the text separated by r is "+sp_lines.length)

			var text_more = " ";
			for(var i = 0; i < sp_lines.length; i++){
				text_more=text_more+" "+sp_lines[i]+" -"+i;    			
    		}
    		
    		for (var i=0; i<sp_lines.length; i++){
    			var temp = sp_lines[i].split(" ");
    			storepts_x.push(temp[0]);
    			storepts_y.push(temp[1]);
    		}	
    		context.strokeStyle = "#FFF000";
    		draw_points();
		}

		//########################################### YOUR CODE ##########################################
		function get_rlist(){
			//Set of points - rlist generated by sampling the approximate curve represented by the given original data points
			document.getElementById("debug").innerHTML = "Get r list to be implemented";
		}
		
		function get_qHlist(){
			//For each r of the rlist a local plane is approximated which is H and q is the local origin for that
			//So this function is required to give out list of Hs and list of qs 
			document.getElementById("debug").innerHTML = "Get q and H lists to be implemented";
		}

		function get_q_list(){
			//For each q, H pair you will generate a q` that is the smoothened point. q`list is the MLS output		
			document.getElementById("debug").innerHTML = "Get q` for each r to be implemented";
		}


		
	</script>
</body>
</html>
